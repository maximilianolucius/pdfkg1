<div class="row">
    <div class="col-md-4">
        <h3><i class="fas fa-cog"></i> Configuration</h3>

        <div class="card">
            <div class="card-body">
                <form id="ingestForm" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="pdfFiles" class="form-label">Upload PDF(s)</label>
                        <input type="file" class="form-control" id="pdfFiles" name="files" accept=".pdf" multiple required>
                        <div class="form-text">Select one or multiple PDF files</div>
                    </div>

                    <div class="mb-3">
                        <label for="embedModel" class="form-label">Embedding Model</label>
                        <select class="form-select" id="embedModel" name="embed_model">
                            <option value="sentence-transformers/all-MiniLM-L6-v2" selected>all-MiniLM-L6-v2 (fast)</option>
                            <option value="sentence-transformers/all-mpnet-base-v2">all-mpnet-base-v2 (accurate)</option>
                            <option value="BAAI/bge-small-en-v1.5">bge-small-en-v1.5</option>
                            <option value="BAAI/bge-base-en-v1.5">bge-base-en-v1.5</option>
                        </select>
                        <div class="form-text">Model for semantic search</div>
                    </div>

                    <div class="mb-3">
                        <label for="maxTokens" class="form-label">Max Tokens per Chunk: <span id="maxTokensValue">500</span></label>
                        <input type="range" class="form-range" id="maxTokens" name="max_tokens" min="100" max="1000" step="50" value="500">
                        <div class="form-text">Smaller = more precise, Larger = more context</div>
                    </div>

                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="useGemini" name="use_gemini">
                        <label class="form-check-label" for="useGemini">
                            Use Gemini for Visual Analysis
                        </label>
                        <div class="form-text">Extract cross-references from diagrams (requires GEMINI_API_KEY)</div>
                    </div>

                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="forceReprocess" name="force_reprocess">
                        <label class="form-check-label" for="forceReprocess">
                            Force Reprocess
                        </label>
                        <div class="form-text">Reprocess PDF even if cached</div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-lg w-100" id="processBtn">
                        <i class="fas fa-rocket"></i> Process PDF
                    </button>
                </form>
            </div>
        </div>
    </div>

    <div class="col-md-8">
        <h3><i class="fas fa-chart-bar"></i> Processing Status</h3>

        <div class="card">
            <div class="card-body">
                <!-- Progress bar -->
                <div id="progressContainer" class="mb-3" style="display: none;">
                    <div class="progress">
                        <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%">0%</div>
                    </div>
                    <div id="progressText" class="text-center mt-2"></div>
                </div>

                <!-- Status message -->
                <div id="statusOutput" class="markdown-body">
                    <p>Upload PDF(s) and click <strong>Process PDF</strong> to populate the knowledge graph.</p>
                </div>
            </div>
        </div>

        <!-- Reset button -->
        <div class="mt-3">
            <button type="button" class="btn btn-danger" id="resetBtn">
                <i class="fas fa-recycle"></i> Reset Project Data
            </button>
            <div class="form-text text-danger">
                ⚠️ <strong>Dangerous:</strong> Clears data/output/ and rebuilds the pdfkg database in ArangoDB and Milvus.
            </div>
        </div>
    </div>
</div>
